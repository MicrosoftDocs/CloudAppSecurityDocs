---
title: Create app policies in app governance
ms.date: 02/28/2023
ms.topic: how-to
description: Learn how to create app policies on app governance.
---

# Create app policies in app governance

Along with a built-in set of capabilities to detect anomalous app behavior and generate alerts based on machine learning algorithms, policies in app governance enable you to:

- Specify conditions by which app governance alerts you to app behavior for automatic or manual remediation.

- Enforce the app compliance policies for your organization.

> [!NOTE]
> You can now create OAuth app policies for Azure AD, Google and Salesforce in app governance. 

> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE4YU37]

## Create OAuth app policies for Azure AD

You can create app policies from provided templates that can be customized, or you can create your own custom app policy.

To create a new app policy for Azure AD apps, go to **Microsoft 365 Defender > App governance > Overview page > Policies > Azure AD**. 

![Azure AD-policies](media/app-governance-app-policies-create/azure-ad-policies.jpg)

Select the **Create New Policy** option:

- To create a new app policy from a template, choose the relevant template category followed by the template in that category.
- To create a custom policy, select the **Custom** category.

    ![Create a policy.](media/app-governance/app-governance-create-policy.png)

## App policy templates

To create a new app policy based on an app policy template, on the **Choose App policy template page**, select a category of app template, select the name of the template, and then select **Next**.

App governance has three categories of app policy templates.

### Usage

App governance includes these templates to generate alerts for app usage.
<br>


****
|Template name|Description|
|---|---|
|Unused app | Find apps that have not signed in recently. This policy checks the following conditions: <br /><br /> <li> Last used: more than 30 days ago |
|New app with high data usage|Find newly registered apps that have uploaded or downloaded large amounts of data using Graph API. This policy checks the following conditions:<br /><br /><li>Registration age: Seven days or less (customizable)<br /><li>Data usage: Greater than 1 GB in one day (customizable)|
|Increase in users|Find apps with a sizable increase in the number of users. This policy checks the following conditions:<br /><br /> <li> Time range: Last 90 days<br /> <li> Increase in consenting users: At least 50% (customizable)|

### Permissions

App governance includes these templates to generate alerts for app permissions.
<br>


****
|Template name|Description|
|---|---|
|Unused credentials | Find apps with one or more credentials that have not been used recently. This policy checks the following conditions: <br /><br /> <li> Credential last used date: greater than 30 days ago. |
|Overprivileged app|Find apps that have unused Graph API permissions. These apps have been granted permissions that could be unnecessary for regular use.|
|New highly privileged app|Find newly registered apps that have been granted write access and other powerful Graph API permissions. This policy checks the following conditions:<br /><br /><li>Registration age: Seven days or less (customizable)|
|New app with non-Graph API permissions|Find newly registered apps that have permissions to non-Graph APIs. These apps can expose you to risks if the APIs they access receive limited support and updates. <br />This policy checks the following conditions:<br /><br /><li>Registration age: Seven days or less (customizable)<br /><li> Non-Graph API permissions: Yes|
| Expiring credentials | Find apps with credentials that are expiring within a certain period. This policy checks the following conditions: <br /><br /> <li>  Credential expiration date: within 30 days |

### Certification

App governance includes these templates to generate alerts for Microsoft 365 certification.
<br>


****
|Template name|Description|
|---|---|
|New uncertified app|Find newly registered apps that don’t have publisher attestation or Microsoft 365 certification. This policy checks the following conditions:<br /><br /><li>Registration age: Seven days or less (customizable)<br /><li>Certification: No certification (customizable)|
|||

## Custom policies

Use a custom app policy when you need to do something not already done by one of the built-in templates.

1. To create a new custom app policy, first select **Create new policy** on the **Policies** page. On the **Choose App policy template page**, select the **Custom** category, the **Custom policy** template, and then select **Next**.

1. On the **Name and description** page, configure the following:

    - Policy Name
    - Policy Description
    - Select the policy severity, which sets the severity of alerts generated by this policy.
      - High
      - Medium
      - Low

1. On the **Choose Policy settings and conditions** page, for **Choose which apps this policy is applicable for**, select:

    - All Apps
    - Choose specific apps
    - All apps except

1. If you choose specific apps, or all apps except for this policy, select **Add apps** and select the desired apps from the list. In the **Choose apps** pane, you can select multiple apps to which this policy will be applied, and then select **Add**. Select **Next** when you're satisfied with the list.

1. Select **Edit conditions**. Select **Add condition** and choose a condition from the list. Set the desired threshold for your selected condition. Repeat to add more conditions. Select **Save** to save the rule, and when you're finished adding rules, select **Next**.

    > [!NOTE]
    > Some policy conditions are only applicable to apps that access Graph API permissions. When evaluating apps that access only non-Graph APIs, app governance will skip these policy conditions and proceed to check only other policy conditions.

1. Here are the available conditions for a custom app policy:

    | Condition                            | Condition values accepted                                    | Description                                                  | More information                                             |
    | ------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
    | Registration age                     | Within last X days                                           | Apps that were registered to Azure AD within a specified period from the current date |                                                              |
    | Certification                        | No certification, Publisher attested, Microsoft 365 Certified | Apps that are Microsoft 365 Certified, have a publisher attestation report, or neither | [Microsoft 365 Certification](/microsoft-365-app-certification/docs/enterprise-app-certification-guide) |
    | Publisher verified                   | Yes or No                                                    | Apps that have verified publishers                           | [Publisher Verification](/azure/active-directory/develop/publisher-verification-overview) |
    | Application permissions (Graph only) | Select one or more API permissions from list                 | Apps with specific Graph API permissions that have been granted directly | [Microsoft Graph permissions reference](/graph/permissions-reference) |
    | Delegated permissions (Graph only)   | Select one or more API permissions from list                 | Apps with specific Graph API permissions that have been given by a user | [Microsoft Graph permissions reference](/graph/permissions-reference) |
    | Highly privileged (Graph only)       | Yes or No                                                    | Apps with relatively powerful Graph API permissions          | This is an internal designation based on the same logic used by Defender for Cloud Apps. |
    | Overprivileged (Graph only)          | Yes or No                                                    | Apps with unused Graph API permissions                       | Apps with more granted permissions than are being used by those apps. |
    | Non-Graph API permissions            | Yes or No                                                    | Apps with permissions to non-Graph APIs. These apps can expose you to risks if the APIs they access receive limited support and updates. |                                                              |
    | Data usage (Graph only)              | Greater than X GB of data downloaded and uploaded per day    | Apps that have read and written more than a specified amount of data using Graph API |                                                              |
    | Data usage trend (Graph only)        | X % increase in data usage compared to previous day          | Apps whose data reads and writes using Graph API have increased by a specified percentage compared to the previous day |                                                              |
    | API access (Graph only)              | Greater than X API calls per day                             | Apps that have made over a specified number of Graph API calls in a day |                                                              |
    | API access trend (Graph only)        | X % increase in API calls compared to previous day           | Apps whose number of Graph API calls have increased by a specified percentage compared to the previous day |                                                              |
    | Number of consenting users           | (Greater than or Less than) X consented users                | Apps that have been given consent by a greater or fewer number of users than specified |                                                              |
    | Increase in consenting users         | X % increase in users in the last 90 days                    | Apps whose number of consenting users have increased by over a specified percentage in the last 90 days |                                                              |
    | Priority account consent given       | Yes or No                                                    | Apps that have been given consent by priority users          | A user with a [priority account](/microsoft-365/admin/setup/priority-accounts). |
    | Names of consenting users            | Select users from list                                       | Apps that have been given consent by specific users          |                                                              |
    | Roles of consenting users            | Select roles from list                                       | Apps that have been given consent by users with specific roles | Multiple selections allowed. <p> Any Azure AD role with assigned member should be made available in this list. |
    | Sensitivity labels accessed          | Select one or more sensitivity labels from the list          | Apps that accessed data with specific sensitivity labels in the last 30 days. |                                                              |
    | Services accessed (Graph only)       | Exchange and/or OneDrive and/or SharePoint and/or Teams      | Apps that have accessed OneDrive, SharePoint, or Exchange Online using Graph API | Multiple selections allowed.                                 |
    | Error rate (Graph only)              | Error rate is greater than X% in the last seven days         | Apps whose Graph API error rates in the last 7 days are greater than a specified percentage |                                                              |
    | Unused app                           | Not signed in for 30 days to 1 year                          | Apps that have not authenticated within a specified period from the current date |                                                              |
    | Unused credentials                   | Any credentials not used within the last 30 days to 1 year   | Apps with one or more credentials that have not been used within a specified period from the current date |                                                              |
    | Credential expiration                | Any credential that expires within or after X days           | Apps whose credentials expire within or after a certain period |                                                              |

    All of the specified conditions must be met for this app policy to generate an alert.

1. When you're done specifying the conditions, select **Save**, and then select **Next**.
1. On the **Define Policy Actions** page, select **Disable app** if you want app governance to disable the app when an alert based on this policy is generated, and then select **Next**. Use caution when applying actions because a policy may affect users and legitimate app use.

1. On the **Define Policy Status** page, select one of these options:

    - **Audit mode**: Policies are evaluated but configured actions won't occur. Audit mode policies appear with the status of **Audit** in the list of policies. You should use Audit mode for testing a new policy.
    - **Active**: Policies are evaluated and configured actions will occur.
    - **Inactive**: Policies aren't evaluated and configured actions won't occur.

1. Carefully review all parameters of your custom policy. Select **Submit** when you're satisfied. You can also go back and change settings by selecting **Edit** beneath any of the settings.

## Test and monitor your new app policy

Now that your app policy is created, you should monitor it on the **Policies** page to ensure it's registering an expected number of active alerts and total alerts during testing.

:::image type="content" source="media\app-governance\mapg-cc-policies-policy.png" alt-text="The app governance policies summary page in the Microsoft 365 Defender with a highlighted policy." lightbox="media\app-governance\mapg-cc-policies-policy.png":::

If the number of alerts is an unexpectedly low value, edit the settings of the app policy to ensure you've configured it correctly before setting its status.

Here's an example of a process for creating a new policy, testing it, and then making it active:

1. Create the new policy with severity, apps, conditions, and actions set to initial values and the status set to **Audit mode**.
2. Check for expected behavior, such as alerts generated.
3. If the behavior isn't expected, edit the policy apps, conditions, and action settings as needed and go back to step 2.
4. If the behavior is expected, edit the policy and change its status to **Active**.

:::image type="content" source="media/app-governance/mapg-create-new-policy-process.png" alt-text="The create app policy workflow." lightbox="media/app-governance/mapg-create-new-policy-process.png":::

## Create OAuth app policies for Salesforce, Google and other apps

To create a new app policy for Salesforce, Google and other apps, go to **Microsoft 365 Defender > App governance > Policies > Other apps**.

![Other apps-policy creation](media/app-governance-app-policies-create/other-apps-policy-creation.jpg)

## Next step

[Manage your app policies.](app-governance-app-policies-manage.md)

